<html>
<head>
  <title>Test virtual-ip</title>
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="600">
  <tr><td>
    <div><a href="../../index.html">strongSwan KVM Tests</a> / <a href="../index.html">virtual-ip</a> / dave</div>
    <h2>Test virtual-ip</h2>
    <h3>Description</h3>
The roadwarriors <b>carol</b> and <b>dave</b> both set up a connection to gateway <b>moon</b>.
The roadwarriors each unilaterally define a static virtual IP using the <b>leftsourceip</b>
parameter. In order to detect potential address conflicts, the roadwarriors send
their virtual IPs embedded in a configuration payload to <b>moon</b> for verification.
In our scenario <b>moon</b> accepts the address choices thus allowing <b>carol</b> and
<b>dave</b> to install their respective virtual IP addresses.
<p>
In order to test the tunnels both <b>carol</b> and <b>dave</b> ping the client <b>alice</b>
behind the gateway <b>moon</b> as well as the inner interface of the gateway.
The latter ping requires access to the gateway itself which is granted by the
directive <b>lefthostaccess=yes</b>. The source IP of the two pings will be the virtual
IP addresses <b>carol1</b> and <b>dave1</b>, respectively. Also thanks to the automatically
configured source route entries, <b>moon</b> is able to ping both roadwarriors by using the
established net-net IPsec tunnels.
    <ul>
      <li><a href="console.log">console.log</a></li>
    </ul>
    <img src="../../images/a-m-c-w-d.png" alt="alice moon carol winnetou dave">
    <h3>moon</h3>
      <table border="0" cellspacing="0" width="600">
      <tr>
	<td valign="top">
	  <ul>
	    <li><a href="moon.ipsec.conf">ipsec.conf</a></li>
	    <li><a href="moon.ipsec.secrets">ipsec.secrets</a></li>
	    <li><a href="moon.ipsec.sql">ipsec.sql</a></li>
	    <li><a href="moon.strongswan.conf">strongswan.conf</a></li>
	  </ul>
	</td>
	<td valign="top">
	  <ul>
	    <li><a href="moon.statusall">ipsec statusall</a></li>
	    <li><a href="moon.listall">ipsec listall</a></li>
	    <li><a href="moon.auth.log">auth.log</a></li>
	    <li><a href="moon.daemon.log">daemon.log</a></li>
	  </ul>
      </td>
	<td valign="top">
	  <ul>
	    <li><a href="moon.ip.policy">ip -s xfrm policy</a></li>
	    <li><a href="moon.ip.state">ip -s xfrm state</a></li>
	    <li><a href="moon.ip.route"></a></li>
	    <li><a href="moon.iptables"></a></li>
	    <li><a href="moon.iptables-save"></a></li>
	  </ul>
      </td>
    </tr>
    </table>
    <h3>carol</h3>
      <table border="0" cellspacing="0" width="600">
      <tr>
	<td valign="top">
	  <ul>
	    <li><a href="carol.ipsec.conf">ipsec.conf</a></li>
	    <li><a href="carol.ipsec.secrets">ipsec.secrets</a></li>
	    <li><a href="carol.ipsec.sql">ipsec.sql</a></li>
	    <li><a href="carol.strongswan.conf">strongswan.conf</a></li>
	  </ul>
	</td>
	<td valign="top">
	  <ul>
	    <li><a href="carol.statusall">ipsec statusall</a></li>
	    <li><a href="carol.listall">ipsec listall</a></li>
	    <li><a href="carol.auth.log">auth.log</a></li>
	    <li><a href="carol.daemon.log">daemon.log</a></li>
	  </ul>
      </td>
	<td valign="top">
	  <ul>
	    <li><a href="carol.ip.policy">ip -s xfrm policy</a></li>
	    <li><a href="carol.ip.state">ip -s xfrm state</a></li>
	    <li><a href="carol.ip.route"></a></li>
	    <li><a href="carol.iptables"></a></li>
	    <li><a href="carol.iptables-save"></a></li>
	  </ul>
      </td>
    </tr>
    </table>
    <h3>dave</h3>
      <table border="0" cellspacing="0" width="600">
      <tr>
	<td valign="top">
	  <ul>
	    <li><a href="dave.ipsec.conf">ipsec.conf</a></li>
	    <li><a href="dave.ipsec.secrets">ipsec.secrets</a></li>
	    <li><a href="dave.ipsec.sql">ipsec.sql</a></li>
	    <li><a href="dave.strongswan.conf">strongswan.conf</a></li>
	  </ul>
	</td>
	<td valign="top">
	  <ul>
	    <li><a href="dave.statusall">ipsec statusall</a></li>
	    <li><a href="dave.listall">ipsec listall</a></li>
	    <li><a href="dave.auth.log">auth.log</a></li>
	    <li><a href="dave.daemon.log">daemon.log</a></li>
	  </ul>
      </td>
	<td valign="top">
	  <ul>
	    <li><a href="dave.ip.policy">ip -s xfrm policy</a></li>
	    <li><a href="dave.ip.state">ip -s xfrm state</a></li>
	    <li><a href="dave.ip.route"></a></li>
	    <li><a href="dave.iptables"></a></li>
	    <li><a href="dave.iptables-save"></a></li>
	  </ul>
      </td>
    </tr>
    </table>
	<h3>tcpdump</h3>
	<ul>
	    <li><a href="moon.tcpdump.log">moon tcpdump.log</a></li>
	    <li><a href="alice.tcpdump.log">alice tcpdump.log</a></li>
	</ul>
  </td></tr>
</table>
</body>
</html>
  <tr>
    <td>2</td>
    <td><a href="dave/index.html">dave</a></td>
    <td><a href="dave/console.log"><font color="red">failed</font></a></td>
    <td>&nbsp;</td>
  </tr>
